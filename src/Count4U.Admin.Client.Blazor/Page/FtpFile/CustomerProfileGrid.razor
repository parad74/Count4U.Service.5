@page "/customergrid"
@namespace Count4U.Admin.Client.Page
@inherits CustomerProfileGridBase
@attribute [Authorize(Policy = UserPolicy.IsProfile)]

<AuthorizeView Policy="@UserPolicy.IsProfile">


    @if (_profileFiles == null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {
        @if (IsSearching)
        {
            <button class="btn btn-primary float-right search disabled" disabled><span class='fa-left fas fa-sync-alt spinning'></span>Searching...</button>
        }
        else
        {
            <button class="btn btn-primary btn-outline-primary float-right search" @onclick="@(()=>OnSearchAsync())">Search</button>
        }

        <PagedDataList Data=@_profileFiles Prev="Prev" Next="Next" ItemsPerPage="10">
            <ListTemplate Context="listOfCustomer">
                <h6 class="bg-success p-1 text-white">Customer with Branches</h6>
                <table class="table table-bordered table-sm">
                    @*<thead>
                            <tr>
                                <th scope="col">Id</th>
                                <th scope="col">Name</th>
                                <th scope="col">Users</th>
                                <th scope="col">Edit</th>
                            </tr>
                        </thead>*@
                    <tbody>
                        @listOfCustomer
                    </tbody>
                </table>
            </ListTemplate>
            <ItemTemplate Context="customer">
                <tr @key=@customer>
                    @*<td>@role.RoleID</td>*@
                    <td style="padding-left: 30px;padding-right: 30px;width:132px">@customer.CustomerCode</td>
                    <td>@customer.ToString()</td>
                    @*<td>
                            <ul class="nav flex-column">
                                @foreach (var user in role.Members)
                                    {
                                    <li @key=@user.UserID>
                                        @user.Email
                                    </li>
                                    }
                            </ul>
                        </td>*@
                    @*<td style="align-content:center;padding-left: 30px;padding-right: 30px">*@
                    <td style="padding-left: 30px;padding-right: 30px;width:152px">
                        <button class="btn btn-outline-success  btn-sm" style="width:90px" @onclick="@(()=>NavigateToBranches(customer.CustomerCode))">
                            <span>Branches</span>
                        </button>
                    </td>
                </tr>
            </ItemTemplate>
        </PagedDataList>
    }

</AuthorizeView>